<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
<title>tdm. qdap 1.3.1</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="author" content="">

<link href="css/bootstrap.css" rel="stylesheet">
<link href="css/bootstrap-responsive.css" rel="stylesheet">
<link href="css/highlight.css" rel="stylesheet">
<link href="css/staticdocs.css" rel="stylesheet">

<!--[if lt IE 9]>
  <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->
  </head>

  <body>
    <div class="navbar">
  <div class="navbar-inner">
    <div class="container">
      <a class="brand" href="#">qdap 1.3.1</a>
      <div class="nav">
        <ul class="nav">
          <li><a href="index.html"><i class="icon-home icon-white"></i> Index</a></li>
        </ul>
      </div>
    </div>
  </div>
</div>

    <div class="container">
      <header>
        
      </header>
      
      <h1>tm Package Compatibility Tools: Apply to or Convert to/from Term Document
Matrix or Document Term Matrix</h1>

<div class="row">
  <div class="span8">
    <h2>Usage</h2>
    <pre><div>tdm(text.var, grouping.var&nbsp;=&nbsp;NULL, vowel.check&nbsp;=&nbsp;TRUE, ...)</div>
<div>dtm(text.var, grouping.var&nbsp;=&nbsp;NULL, vowel.check&nbsp;=&nbsp;TRUE, ...)</div>
<div>tm2qdap(x)</div>
<div>tm_corpus2df(tm.corpus, col1&nbsp;=&nbsp;"docs", col2&nbsp;=&nbsp;"text", sent.split&nbsp;=&nbsp;TRUE, ...)</div>
<div>tm_corpus2wfm(tm.corpus, col1&nbsp;=&nbsp;"docs", col2&nbsp;=&nbsp;"text", ...)</div>
<div>df2tm_corpus(text.var, grouping.var&nbsp;=&nbsp;NULL, demographic.vars, ...)</div>
<div>apply_as_tm(wfm.obj, tmfun, ..., to.qdap&nbsp;=&nbsp;TRUE)</div>
<div>apply_as_df(tm.corpus, qdapfun, ..., stopwords&nbsp;=&nbsp;NULL, min&nbsp;=&nbsp;1, max&nbsp;=&nbsp;Inf, count.apostrophe&nbsp;=&nbsp;TRUE, ignore.case&nbsp;=&nbsp;TRUE)</div></pre>
    
    <h2>Arguments</h2>
    <dl>
      <dt>text.var</dt>
      <dd>The text variable or a
  <code>wfm</code> object.</dd>
      <dt>grouping.var</dt>
      <dd>The grouping variables.  Default
  <code>NULL</code> generates one word list for all text.  Also
  takes a single grouping variable or a list of 1 or more
  grouping variables.</dd>
      <dt>...</dt>
      <dd>If <code>tdm</code> or <code>dtm</code> - Other
  arguments passed to <code>wfm</code>.  If <code>apply_as_tm</code> -
  Other arguments passed to functions used on the tm
  package's <code>"TermDocumentMatrix"</code>.  If
  <code>tm_corpus2df</code> - Other arguments passed to
  <code>sentSplit</code>.  If <code>df2tm_corpus</code> -
  Other arguments passed to the tm package's
  <code><a href='http://www.inside-r.org/r-doc/tm/VCorpus'>Corpus</a></code>.  If <code>tm_corpus2wfm</code> -
  Other arguments passed to <code>wfm</code>.</dd>
      <dt>vowel.check</dt>
      <dd>logical.  Should terms without vowels
  be remove?</dd>
      <dt>x</dt>
      <dd>A
  <code><a href='http://www.inside-r.org/r-doc/tm/matrix'>TermDocumentMatrix</a></code>/<code><a href='http://www.inside-r.org/r-doc/tm/matrix'>DocumentTermMatrix</a></code>.</dd>
      <dt>tm.corpus</dt>
      <dd>A <code><a href='http://www.inside-r.org/r-doc/tm/VCorpus'>Corpus</a></code> object.</dd>
      <dt>col1</dt>
      <dd>Name for column 1 (the vector elements).</dd>
      <dt>col2</dt>
      <dd>Name for column 2 (the names of the
  vectors).</dd>
      <dt>sent.split</dt>
      <dd>logical.  If <code>TRUE</code> the text
  variable sentences will be split into individual rows.</dd>
      <dt>demographic.vars</dt>
      <dd>Additional demographic
  information about the grouping variables.  This is a
  data.frame, list of equal length vectors, or a single
  vector corresponding to the grouping variable/text
  variable.  This information will be mapped to the
  DMetaData in the <code><a href='http://www.inside-r.org/r-doc/tm/VCorpus'>Corpus</a></code>.</dd>
      <dt>wfm.obj</dt>
      <dd>A <code>wfm</code> object.</dd>
      <dt>tmfun</dt>
      <dd>A function applied to a
  <code><a href='http://www.inside-r.org/r-doc/tm/matrix'>TermDocumentMatrix</a></code> object.</dd>
      <dt>to.qdap</dt>
      <dd>logical.  If <code>TRUE</code> should
  <code>wfm</code> try to coerce the output back to
  a qdap object.</dd>
      <dt>qdapfun</dt>
      <dd>A qdap function that is usually used on
  text.variable ~ grouping variable.</dd>
      <dt>stopwords</dt>
      <dd>A character vector of words to remove
  from the text.  qdap has a number of data sets that can
  be used as stop words including: <code>Top200Words</code>,
  <code>Top100Words</code>, <code>Top25Words</code>.  For the tm
  package's traditional English stop words use
  <code>tm::stopwords("english")</code>.</dd>
      <dt>min</dt>
      <dd>Minimum word length.</dd>
      <dt>max</dt>
      <dd>Maximum word length.</dd>
      <dt>count.apostrophe</dt>
      <dd>logical.  If <code>TRUE</code>
  apostrophes are counted as characters.</dd>
      <dt>ignore.case</dt>
      <dd>logical.  If <code>TRUE</code> stop words
  will be removed regardless of case.</dd>
    </dl>
    
    <div class="Value">
      <h2>Value</h2>
      
      <p><code>tdm</code> - Returns a
<code><a href='http://www.inside-r.org/r-doc/tm/matrix'>TermDocumentMatrix</a></code>.</p>
  
      <p><code>dtm</code> - Returns a
<code><a href='http://www.inside-r.org/r-doc/tm/matrix'>DocumentTermMatrix</a></code>.</p>
  
      <p><code>tm2qdap</code> - Returns a <code>wfm</code> object
or <code>weight</code> object.</p>
  
      <p><code>tm_corpus2df</code> - Converts a <code><a href='http://www.inside-r.org/r-doc/tm/VCorpus'>Corpus</a></code>
and returns a qdap oriented dataframe.</p>
  
      <p><code>df2tm_wfm</code> - Converts a qdap oriented dataframe and
returns a <code>wfm</code>.</p>
  
      <p><code>df2tm_corpus</code> - Converts a qdap oriented dataframe
and returns a <code><a href='http://www.inside-r.org/r-doc/tm/VCorpus'>Corpus</a></code>.</p>
  
      <p><code>apply_as_tm</code> - Applies a tm oriented function to a
<code>wfm</code> and attempts to simplify back to a
<code>wfm</code> or <code>weight</code> format.</p>
  
    </div>

    <div class="Description">
      <h2>Description</h2>
      
      <p><code>tdm</code> - Create term document matrices from raw text or
<code>wfm</code> for use with other text analysis
packages.</p>
  
      <p><code>dtm</code> - Create document term matrices from raw text or
<code>wfm</code> for use with other text analysis
packages.</p>
  
      <p><code>tm2qdap</code> - Convert the <span class = "pkg">tm</span> package's
<code><a href='http://www.inside-r.org/r-doc/tm/matrix'>TermDocumentMatrix</a></code>/<code><a href='http://www.inside-r.org/r-doc/tm/matrix'>DocumentTermMatrix</a></code>
to <code>wfm</code>.</p>
  
      <p><code>tm_corpus2df</code> - Convert a tm package corpus to a
dataframe.</p>
  
      <p><code>tm_corpus2wfm</code> - Convert a <code><a href='http://www.inside-r.org/r-doc/tm/VCorpus'>Corpus</a></code>
package corpus to a <code>wfm</code>.</p>
  
      <p><code>df2tm_corpus</code> - Convert a qdap dataframe to a tm
package <code><a href='http://www.inside-r.org/r-doc/tm/VCorpus'>Corpus</a></code>.</p>
  
      <p><code>apply_as_tm</code> - Apply functions intended to be used on
the <span class = "pkg">tm</span> package's <code><a href='http://www.inside-r.org/r-doc/tm/matrix'>TermDocumentMatrix</a></code>
to a <code>wfm</code> object.</p>
  
      <p><code>apply_as_df</code> - Apply a <span class = "pkg">tm</span>
<code><a href='http://www.inside-r.org/r-doc/tm/VCorpus'>Corpus</a></code> as a qdap dataframe.
<code>apply_as_df</code> - Apply functions intended to be used on
the <span class = "pkg">qdap</span> package's <code><a href='http://www.inside-r.org/r-doc/base/data.frame'>data.frame</a></code> +
<code>sentSplit</code> to a <span class = "pkg">tm</span>
<code><a href='http://www.inside-r.org/r-doc/tm/VCorpus'>Corpus</a></code> object.</p>
  
    </div>

    <div class="Details">
      <h2>Details</h2>
      
      <p>Produces output that is identical to the <code>tm</code>
package's <code><a href='http://www.inside-r.org/r-doc/tm/matrix'>TermDocumentMatrix</a></code>,
<code><a href='http://www.inside-r.org/r-doc/tm/matrix'>DocumentTermMatrix</a></code>,
<code><a href='http://www.inside-r.org/r-doc/tm/VCorpus'>Corpus</a></code> or allows convenient interface
between the qdap and tm packages.</p>
  
    </div>

    <div class="Note">
      <h2>Note</h2>
      
      <p><code>aply_ad_df</code> coerces to a dataframe with columns named
`docs` and the other named `text`.</p>
  
    </div>
    
    <h2 id="examples">Examples</h2>
    <pre class="examples"><div class='input'>## &lt;strong&gt;Not run&lt;/strong&gt;: # dtm(DATA$state, DATA$person)# tdm(DATA$state, DATA$person)# # x &lt;- wfm(DATA$state, DATA$person)# tdm(x)# dtm(x)# library(tm)# plot(tdm(x))# # pres &lt;- tdm(pres_debates2012$dialogue, pres_debates2012$person)# plot(pres, corThreshold = 0.8)# pres# (pres2 &lt;- removeSparseTerms(pres, .3))# plot(pres2, corThreshold = 0.95)# # ## Latent Semantic Analysis# library(lsa)# lsa(tdm(x), dims=dimcalc_share())# lsa(tdm(DATA$state, DATA$person), dims=dimcalc_share())# # shorts &lt;- all_words(pres_debates2012)[,1][nchar(all_words(#     pres_debates2012)[,1]) &lt; 4]# # SW &lt;- c(shorts, qdapDictionaries::contractions[, 1],#     qdapDictionaries::Top200Words,#     &quot;governor&quot;, &quot;president&quot;, &quot;mister&quot;, &quot;obama&quot;,&quot;romney&quot;)# # DocTermMat2 &lt;- with(pres_debates2012, dtm(dialogue, list(person, time), stopwords = SW))# DocTermMat2 &lt;- removeSparseTerms(DocTermMat2,0.95)# DocTermMat2 &lt;- DocTermMat2[rowSums(as.matrix(DocTermMat2))&gt; 0,]# # out &lt;- lsa(DocTermMat2, 6)# out$tk# out2 &lt;- colsplit2df(matrix2df(out$tk), new.names = qcv(Person, Time))# out2$Person &lt;- factor(out2$Person,#     levels = names(sort(colSums(with(pres_debates2012,#         wfm(dialogue, person, stopwords = SW))), TRUE))# )# colnames(out2) &lt;- gsub(&quot;X&quot;, &quot;Topic &quot;, colnames(out2))# # qheat(out2, facet.vars = &quot;Time&quot;, high=&quot;darkgreen&quot;, plot=FALSE) +#     theme(legend.title=element_blank()) +#     guides(fill = guide_colorbar(barwidth = .5, barheight = 12))# # ## Correspondence Analysis# library(ca)# # dat &lt;- pres_debates2012# dat &lt;- dat[dat$person %in% qcv(ROMNEY, OBAMA), ]# # speech &lt;- stemmer(dat$dialogue)# mytable1 &lt;- with(dat, tdm(speech, list(person, time), stopwords = Top25Words))# # fit &lt;- ca(mytable1)# summary(fit)# plot(fit)# plot3d.ca(fit, labels=1)# # # mytable2 &lt;- with(dat, tdm(speech, list(person, time), stopwords = Top200Words))# # fit2 &lt;- ca(mytable2)# summary(fit2)# plot(fit2)# plot3d.ca(fit2, labels=1)# # ## Topic Models# # Example 1 ## library(topicmodels); library(tm)# # # Generate stop words based on short words, frequent words and contractions# shorts &lt;- all_words(pres_debates2012)[,1][nchar(all_words(#     pres_debates2012)[,1]) &lt; 4]# # SW &lt;- c(shorts, qdapDictionaries::contractions[, 1],#     qdapDictionaries::Top200Words,#     &quot;governor&quot;, &quot;president&quot;, &quot;mister&quot;, &quot;obama&quot;,&quot;romney&quot;)# # DocTermMat &lt;- with(pres_debates2012, dtm(dialogue, person, stopwords = SW))# DocTermMat &lt;- removeSparseTerms(DocTermMat,0.999)# DocTermMat &lt;- DocTermMat[rowSums(as.matrix(DocTermMat))&gt; 0,]# # lda.model &lt;- LDA(DocTermMat, 5)# # (topics &lt;- posterior(lda.model, DocTermMat)$topics)# terms(lda.model,20)# # # Plot the Topics Per Person# topic.dat &lt;- matrix2df(topics, &quot;Person&quot;)# colnames(topic.dat)[-1] &lt;- paste2(t(terms(lda.model,20)), sep=&quot;, &quot;)# # library(reshape2)# mtopic &lt;- melt(topic.dat, variable=&quot;Topic&quot;, value.name=&quot;Proportion&quot;)# ggplot(mtopic, aes(weight=Proportion, x=Topic, fill=Topic)) +#     geom_bar() +#     coord_flip() +#     facet_grid(Person~.) +#     guides(fill=FALSE)# # # Example 2 ## DocTermMat2 &lt;- with(pres_debates2012, dtm(dialogue, list(person, time), stopwords = SW))# DocTermMat2 &lt;- removeSparseTerms(DocTermMat2,0.95)# DocTermMat2 &lt;- DocTermMat2[rowSums(as.matrix(DocTermMat2))&gt; 0,]# # lda.model2 &lt;- LDA(DocTermMat2, 6)# # (topics2 &lt;- posterior(lda.model2, DocTermMat2)$topics)# terms(lda.model2,20)# qheat(topics2, high=&quot;blue&quot;, low=&quot;yellow&quot;, by.col=FALSE)# # # Example 3 ## lda.model3 &lt;- LDA(DocTermMat2, 10)# # (topics3 &lt;- posterior(lda.model3, DocTermMat2)$topics)# terms(lda.model3, 20)# qheat(topics3, high=&quot;blue&quot;, low=&quot;yellow&quot;, by.col=FALSE)# # # Plot the Topics Per Person# topic.dat3 &lt;- matrix2df(topics3, &quot;Person&amp;Time&quot;)# colnames(topic.dat3)[-1] &lt;- paste2(t(terms(lda.model3, 10)), sep=&quot;, &quot;)# topic.dat3 &lt;- colsplit2df(topic.dat3)# # library(reshape2)# library(scales)# mtopic3 &lt;- melt(topic.dat3, variable=&quot;Topic&quot;, value.name=&quot;Proportion&quot;)# (p1 &lt;- ggplot(mtopic3, aes(weight=Proportion, x=Topic, fill=Topic)) +#     geom_bar() +#     coord_flip() +#     facet_grid(Person~Time) +#     guides(fill=FALSE) +#     scale_y_continuous(labels = percent) +#     theme(plot.margin = unit(c(1, 0, 0.5, .5), &quot;lines&quot;)) +#     ylab(&quot;Proportion&quot;))# # mtopic3.b &lt;- mtopic3# mtopic3.b[, &quot;Topic&quot;] &lt;- factor(as.numeric(mtopic3.b[, &quot;Topic&quot;]), levels = 1:10)# mtopic3.b[, &quot;Time&quot;] &lt;- factor(gsub(&quot;time &quot;, &quot;&quot;, mtopic3.b[, &quot;Time&quot;]))# # p2 &lt;- ggplot(mtopic3.b, aes(x=Time, y=Topic, fill=Proportion)) +#     geom_tile(color = &quot;white&quot;) +#     scale_fill_gradient(low = &quot;grey70&quot;, high = &quot;red&quot;) +#     facet_grid(Person~Time, scales = &quot;free&quot;) +#     theme(axis.title.y = element_blank(),#         axis.text.x= element_text(colour=&quot;white&quot;),#         axis.ticks.x= element_line(colour=&quot;white&quot;),#         axis.ticks.y = element_blank(),#         axis.text.y= element_blank(),#         plot.margin = unit(c(1, -.5, .5, -.9), &quot;lines&quot;)# )# # library(gridExtra)# grid.arrange(p1, p2, nrow=1, widths = c(.85, .15))# # ## tm Matrices to wfm# library(tm)# data(crude)# # ## A Term Document Matrix Conversion# (tm_in &lt;- TermDocumentMatrix(crude, control = list(stopwords = TRUE)))# converted &lt;- tm2qdap(tm_in)# head(converted)# summary(converted)# # ## A Document Term Matrix Conversion# (dtm_in &lt;- DocumentTermMatrix(crude, control = list(stopwords = TRUE)))# summary(tm2qdap(dtm_in))# # ## `apply_as_tm` Examples# ## Create a wfm# a &lt;- with(DATA, wfm(state, list(sex, adult)))# summary(a)# # ## Apply functions meant for a tm TermDocumentMatrix# out &lt;- apply_as_tm(a, tm:::removeSparseTerms, sparse=0.6)# summary(out)# # apply_as_tm(a, tm:::dissimilarity, method = &quot;cosine&quot;)# apply_as_tm(a, tm:::findAssocs, &quot;computer&quot;, .8)# apply_as_tm(a, tm:::findFreqTerms, 2, 3)# apply_as_tm(a, tm:::Zipf_plot)# apply_as_tm(a, tm:::Heaps_plot)# apply_as_tm(a, tm:::plot.TermDocumentMatrix, corThreshold = 0.4)# # library(proxy)# apply_as_tm(a, tm:::weightBin)# apply_as_tm(a, tm:::weightBin, to.qdap = FALSE)# apply_as_tm(a, tm:::weightSMART)# apply_as_tm(a, tm:::weightTfIdf)# # ## Convert tm Corpus to Dataframe# ## A tm Corpus# library(tm)# reut21578 &lt;- system.file(&quot;texts&quot;, &quot;crude&quot;, package = &quot;tm&quot;)# reuters &lt;- Corpus(DirSource(reut21578),#     readerControl = list(reader = readReut21578XML))# # ## Convert to dataframe# corp_df &lt;- tm_corpus2df(reuters)# htruncdf(corp_df)# # z &lt;- df2tm_corpus(DATA$state, DATA$person,#        demographic=DATA[, qcv(sex, adult, code)])# tm_corpus2df(z)# # ## Apply a qdap function# out &lt;- formality(corp_df$text, corp_df$docs)# plot(out)# # ## Convert a qdap dataframe to tm package Corpus# (x &lt;- with(DATA2, df2tm_corpus(state, list(person, class, day))))# library(tm)# inspect(x)# class(x)# # (y &lt;- with(pres_debates2012, df2tm_corpus(dialogue, list(person, time))))# # ## Add demographic info to DMetaData of Corpus# z &lt;- df2tm_corpus(DATA$state, DATA$person,#     demographic=DATA[, qcv(sex, adult, code)])# lview(z)# # lview(df2tm_corpus(DATA$state, DATA$person,#     demographic=DATA$sex))# # lview(df2tm_corpus(DATA$state, DATA$person,#     demographic=list(DATA$sex, DATA$adult)))# # ## Apply qdap functions meant for dataframes from sentSplit to tm Corpus# library(tm)# reut21578 &lt;- system.file(&quot;texts&quot;, &quot;crude&quot;, package = &quot;tm&quot;)# reuters &lt;- Corpus(DirSource(reut21578),#     readerControl = list(reader = readReut21578XML))# # matches &lt;- list(#     oil = qcv(oil, crude),#     money = c(&quot;economic&quot;, &quot;money&quot;)# )# # apply_as_df(reuters, word_stats)# apply_as_df(reuters, formality)# apply_as_df(reuters, word_list)# apply_as_df(reuters, polarity)# apply_as_df(reuters, Dissimilarity)# apply_as_df(reuters, diversity)# apply_as_df(reuters, pos_by)# apply_as_df(reuters, flesch_kincaid)# apply_as_df(reuters, trans_venn)# apply_as_df(reuters, gantt_plot)# apply_as_df(reuters, rank_freq_mplot)# apply_as_df(reuters, character_table)# # (termco_out &lt;- apply_as_df(reuters, termco, match.list = matches))# plot(termco_out, values = TRUE, high=&quot;red&quot;)# # (wordcor_out &lt;- apply_as_df(reuters, word_cor, word = unlist(matches)))# plot(wordcor_out)# # (f_terms &lt;- apply_as_df(reuters, freq_terms, at.least = 3))# plot(f_terms)# # apply_as_df(reuters, trans_cloud)# ## To use &quot;all&quot; rather than &quot;docs&quot; as &quot;grouping.var&quot;...# apply_as_df(reuters, trans_cloud, grouping.var=NULL,#     target.words=matches, cloud.colors = c(&quot;red&quot;, &quot;blue&quot;, &quot;grey75&quot;))# # finds &lt;- apply_as_df(reuters, freq_terms, at.least = 5,#     top = 5, stopwords = Top100Words)# apply_as_df(reuters, dispersion_plot, match.terms = finds[, 1],#     total.color = NULL)# ## &lt;strong&gt;End(Not run)&lt;/strong&gt;</div></pre>
  </div>
  <div class="span4">
    <!-- <ul>
      <li>apply_as_df</li><li>apply_as_tm</li><li>df2tm_corpus</li><li>dtm</li><li>tdm</li><li>tm2qdap</li><li>tm_corpus2df</li><li>tm_corpus2wfm</li>
    </ul>
    <ul>
      
    </ul> -->
      
    <h2>See also</h2>
    
<code><a href='http://www.inside-r.org/r-doc/tm/matrix'>DocumentTermMatrix</a></code>,
<code><a href='http://www.inside-r.org/r-doc/tm/VCorpus'>Corpus</a></code>,
<code><a href='http://www.inside-r.org/r-doc/tm/matrix'>TermDocumentMatrix</a></code>

<code>Filter</code>

        
  </div>
</div>
      
      <footer>
      <p class="pull-right"><a href="#">Back to top</a></p>
<p>Built by <a href="https://github.com/hadley/staticdocs">staticdocs</a>. Styled with <a href="http://twitter.github.com/bootstrap">bootstrap</a>.</p>
      </footer>
    </div>
  </body>
</html>