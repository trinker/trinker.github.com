---
title: "Dissertation Demonstrations"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output:
  html_document:
    theme: "readable"
    toc: true 
---


```{r setup, echo=FALSE}
pacman::p_load(knitr, rgl)
knit_hooks$set(webgl = hook_webgl)
knitr::opts_chunk$set(echo=FALSE, messages=FALSE, warnings=FALSE)
# options(digits = 4)
```

```{r captions, echo=FALSE}
pacman::p_load_current_gh("adletaw/captioner")

tb <- captioner(prefix = "Table")
fg <- captioner(prefix = "Figure")

fg1 <- fg(name = "randu1", caption = "An interactive 3-D scatterplot of [RANDU](https://en.wikipedia.org/wiki/RANDU) generated data.  While the data was intended to be random, rotating the plot will eventually reveal non-random structures in the data.  Try rotating this scatterplot to reveal the non-random structures.")

fg2 <- fg(name = "randu2", caption = "An interactive 3-D scatterplot of R's `runif` generated data.  Unlike the RANDU generated data, rotating the plot will not reveal non-random structures in the data.")
```

# RANDU Exposed

## RANDU Output

```{r testgl1, webgl=TRUE}
seed <- as.double(1)
RANDU <- function() {
    seed <<- ((2^16 + 3) * seed) %% (2^31)
    seed/(2^31)
}

set.seed(10)
dat <- t(sapply(1:2000, function(i){
    U <- c(RANDU(), RANDU(), RANDU(), RANDU(), RANDU())
    round(U[1:3], 6)
}))


plot3d(dat, col="black", size=3, xlab='x', ylab='y', zlab='z')
```
`r fg1`

## R Random Uniform Output

```{r testgl2, webgl=TRUE}
dat2 <- matrix(runif(6000, 0, 1), ncol=3)
plot3d(dat2, col="black", size=3, xlab='x', ylab='y', zlab='z')
```

`r fg2`
